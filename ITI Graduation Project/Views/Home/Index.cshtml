@{
    ViewData["Title"] = "Admin Dashboard";
    var productsOwned = ViewBag.ProductsOwned as int? ?? 0;
    var totalPurchases = ViewBag.TotalPurchases as int? ?? 0;
    var recent = ViewBag.RecentPurchases as List<ITI_Graduation_Project.Models.Purchase> ?? new List<ITI_Graduation_Project.Models.Purchase>();
}

<div class=" " style="min-height:100dvh; min-width:100%; ">
    <h1 style="">Admin Dashboard</h1>
    <hr />
    <div class="text-center gap-4" style=" display:flex; ">
        <div class="card px-5 py-4 bg-info bg-opacity-25">
            <h4 class="mb-sm-4">Products Owned</h4>
            <h3 class="">@productsOwned</h3>
        </div>
        <div class="card px-5 py-4 bg-primary bg-opacity-25">
            <h4 class="mb-sm-4">Number of Purchases</h4>
            <h3 class="">@totalPurchases</h3>
        </div>
    </div>
    <div class="px-4 py-3" style="width:100%; height:100%; margin-top:80px;">
        <h4>Top 5 Recent Purchases</h4>
        <table class="table">
            <thead>
                <tr>
                    <th>Product Image</th>
                    <th>Product Name</th>
                    <th>Customer Name</th>
                    <th>Date/Time</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var p in recent)
                {
                    <tr>
                        <td>
                            @if (!string.IsNullOrEmpty(p.Product?.ImagePath))
                            {
                                <img src="@p.Product.ImagePath" style="max-width:80px; max-height:60px;" />
                            }
                        </td>
                        <td>
                            <a asp-controller="Products" asp-action="Details" asp-route-id="@p.ProductId">@p.Product?.Name </a>
                        </td>
                        <td>
                            <a asp-controller="Customers" asp-action="Details" asp-route-id="@p.Customer.Id">@p.Customer?.FullName</a>
                        </td>
                        <td>
                        @(p.PurchaseDate.ToString("hh:mm tt, MMM d yyyy"))
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
